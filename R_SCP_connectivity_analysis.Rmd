---
title: "SCP Connectivity Analysis"
output: html_notebook
---

Sam Audrain June 2021
V 0.0.2
 
# Packages and functions
```{r}
library(dplyr)
library(ggplot2)
library(psych)

```

# Read in data
```{r}

###### CHANGE PATH FOR YOUR DATA #######
data<-read.csv("~/Dropbox/Sam/Schema_Consolidation_Project/R_SCP/SCP_StatsModels_GitHub/SCP_connectivity_data.csv")

```

# Correlation tests
```{r}
attach(data)

# a priori hypothesis testing: Do people with greater post-encoding anterior hippocampal-mPFC coupling have coarser congruent memories 3 days later?
cor.test(post_pre_AH_mPFC, coarse_related_long, alternative = "greater")

# exploratory correlations 
cor.test(post_pre_AH_mPFC, coarse_related_short, alternative = "two.sided")
cor.test(post_pre_AH_mPFC, fine_related_long, alternative = "two.sided")
cor.test(post_pre_AH_mPFC, coarse_unrelated_long, alternative = "two.sided")
cor.test(post_pre_AH_mPFC, fine_unrelated_long, alternative = "two.sided")

```

# Plot the a priori correlation 

Fig.3 of main manuscript
```{r, fig.height=6,fig.width=5.5}

data %>%
  ggplot(aes(y = coarse_related_long, x = post_pre_AH_mPFC)) +
  geom_smooth(method = lm, level = 0.95, color = "black") +
  geom_point(size = 5) +
  theme_classic() +
  theme(text = element_text(size = 18), axis.text.x = element_text(size=18), axis.text.y = element_text(size=18), plot.title = element_text(face="bold", hjust=0.5, size=22), legend.position="bottom")+
  scale_shape_manual(values=c(20))+
  guides(shape = FALSE, size = FALSE)+
  labs(y = "coarse congruent retrieval (% of congruent)",
       x = "ant. hipp - mPFC connectivity (post-pre)",
       title = "")

```


# Supplementary Method 4: Comparison of connectivity-memory correlations 
```{r}
attach(data)

#paired correlation tests Williams test

#testing diff beteen congruent coarse and fine 
cor.test(post_pre_AH_mPFC, coarse_related_long, alternative = "greater") #n=17
cor.test(post_pre_AH_mPFC, fine_related_long, alternative = "two.sided")
cor.test(coarse_related_long, fine_related_long, alternative = "greater") 
paired.r(0.456, -0.241, yz=-0.086, n=17) #marginal 

#testing difference between congruent and incongruent coarse 
cor.test(post_pre_AH_mPFC, coarse_related_long, alternative = "greater") #n=17
cor.test(post_pre_AH_mPFC, coarse_unrelated_long, alternative = "two.sided")
cor.test(coarse_related_long, coarse_unrelated_long, alternative = "greater") 
paired.r(0.456, 0.194, yz=0.296, n=17) #not sig

#testing difference between congruent coarse and incongruent detailed 
cor.test(post_pre_AH_mPFC, coarse_related_long, alternative = "greater") #n=17
cor.test(post_pre_AH_mPFC, fine_unrelated_long, alternative = "two.sided")
cor.test(coarse_related_long, fine_unrelated_long, alternative = "greater") 
paired.r(0.456, -0.40, yz=0.11, n=17) #sig 

```

Supplementary Fig.4
```{r, fig.height=6,fig.width=6.5}
data2<-read.csv("~/Dropbox/Sam/Schema_Consolidation_Project/R_SCP/SCP_StatsModels_GitHub/SCP_connectivity_data_long.csv")

data2 %>%
  ggplot(aes(y = accuracy_gran, x = post_pre_AH_mPFC, color=cond)) +
  #geom_ribbon(aes)
  geom_smooth(method = lm, level = 0.95) +
  theme_classic() +
  theme(text = element_text(size = 18), axis.text.x = element_text(size=18), axis.text.y = element_text(size=18), plot.title =     element_text(face="bold", hjust=0.5, size=22), legend.position="right")+
  scale_color_manual(values=c("#081d58","#2c7fb8","#006837","#41ab5d"),labels=c("coarse congruent","detailed congruent","coarse incongruent","detailed incongruent"))+
  guides(shape = FALSE, size = FALSE)+
  labs(y = "% retrieved",
       x = "ant hipp - mPFC connectivity (post-pre)",
       title = "")
```

# Supplementary Method 9: Relationship between connectivity and integration. 

```{r, fig.height=6,fig.width=6.5}

data %>%
  ggplot(aes(y = R_wincon_minus_xcon_long_mPFC, x = post_pre_AH_mPFC)) +
  geom_smooth(method = lm, level = 0.90, color = "black") +
  geom_point(size = 5) +
  theme_classic() +
  theme(text = element_text(size = 18), axis.text.x = element_text(size=18), axis.text.y = element_text(size=18), plot.title = element_text(face="bold", hjust=0.5, size=22), legend.position="bottom")+
  scale_shape_manual(values=c(20))+
  guides(shape = FALSE, size = FALSE)+
  labs(y = "mPFC integration",
       x = "ant. hipp - mPFC connectivity (post-pre)",
       title = "")

attach(data)
cor.test(post_pre_AH_mPFC, R_wincon_minus_xcon_long_mPFC, alternative = "two.sided")


```

# Supplementary Method 15: Post-encoding anterior hippocampus-mPFC connectivity correlation with coarse congruent memory plotted according to counterbalancing group

Supplementary Fig. 13
```{r, fig.height=6,fig.width=5.5}

data %>%
  ggplot(aes(y = coarse_related_long, x = post_pre_AH_mPFC, color = CB)) +
  geom_smooth(method = lm, level = 0.90, color = "black") +
  geom_point(size = 5) +
  theme_classic() +
  theme(text = element_text(size = 18), axis.text.x = element_text(size=18), axis.text.y = element_text(size=18), plot.title = element_text(face="bold", hjust=0.5, size=22), legend.position="bottom")+
  scale_color_manual(values=c("#2c7fb8","#253494"),labels=c("Group B","Group A"))+
  scale_shape_manual(values=c(20))+
  guides(shape = FALSE, size = FALSE)+
  #scale_y_continuous(breaks = seq(0,80,10),expand = c(0, 0), limits = c(0,80))+
  labs(y = "coarse congruent recall (% of congruent)",
       x = "ant. hipp - mPFC connectivity (post-pre)",
       title = "")

```




Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).
